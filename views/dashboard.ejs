<%- include('partials/header'); %>
<a href="/api/users/logout" class="btn btn-secondary">Logout</a>
<a href="/api/users/buyBullet" class="btn btn-warning">Buy Bullet</a>
<div class="container">
  <div class="col-md-8 m-auto">
    <ul class="nav justify-content-center mt-5 mb-5">
      <li class="nav-item">
        <a type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#exampleModal">Make Your
          Picks</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Dashboard</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://www.nfl.com/schedules/" target="_blank">Schedule</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Rules</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Message Board</a>
      </li>
    </ul>
  </div>
  <div class="col-md-6 m-auto">
    <div class="card card-body">
      <h3 class="text-center mb-3"><%= user.name %>'s Dashboard</h3>
      <p>There is a total of <%= users.length %> users with a total of <%= bullets %> bullets</p>
      <p>The Date is now
        <b><%= new Intl.DateTimeFormat('en-GB', { year: 'numeric', month: 'long', day: '2-digit'}).format(new Date()) %></b>
        and the time is now <b><%= new Date().toLocaleTimeString() %></b></p>
    </div>
  </div>

  <div class="table-responsive mt-5">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Player</th>
          <th scope="col">Week &nbsp;1</th>
          <th scope="col">Week &nbsp;2</th>
          <th scope="col">Week &nbsp;3</th>
          <th scope="col">Week &nbsp;4</th>
          <th scope="col">Week &nbsp;5</th>
          <th scope="col">Week &nbsp;6</th>
          <th scope="col">Week &nbsp;7</th>
          <th scope="col">Week &nbsp;8</th>
          <th scope="col">Week &nbsp;9</th>
          <th scope="col">Week 10</th>
          <th scope="col">Week 11</th>
          <th scope="col">Week 12</th>
          <th scope="col">Week 13</th>
          <th scope="col">Week 14</th>
          <th scope="col">Week 15</th>
          <th scope="col">Week 16</th>
          <th scope="col">Week 17</th>
        </tr>
      </thead>
      <tbody>
        <% users.forEach(function(user){ %>
        <% for(i=0; i < user.bullets; i++){ %>
        <tr id="<%= `${user.name}-${i}` %>">
          <th><%= `${user.name} (${i})` %></th>
          <td class="week-1"></td>
          <td class="week-2"></td>
          <td class="week-3"></td>
          <td class="week-4"></td>
          <td class="week-5"></td>
          <td class="week-6"></td>
          <td class="week-7"></td>
          <td class="week-8"></td>
          <td class="week-9"></td>
          <td class="week-10"></td>
          <td class="week-11"></td>
          <td class="week-12"></td>
          <td class="week-13"></td>
          <td class="week-14"></td>
          <td class="week-15"></td>
          <td class="week-16"></td>
          <td class="week-17"></td>
        </tr>
        <% }; %>
        <% }); %>
      </tbody>
    </table>
  </div>


  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Make Your Picks</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i
              class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="accordion" id="accordionExample">
            <div class="accordion-item" >
              <h4 class="accordion-header" id="headingOne">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
                  aria-expanded="true" aria-controls="collapseOne">
                  Week 1
                </button>
              </h4>
              <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <% console.log(picks) %>
                  <form class="mt-3 mb-3" method="POST" action="/api/users/makePicks">
                    <% for(i=0; i < user.bullets; i++){ %>
                    <div class="form-group">
                      <label for="<%= `${user.name}-${i}` %>">Make your pick for bullet <%= `${i}` %></label>
                      <select class="form-control" name="<%= `${user.name}-${i}` %>" id="<%= `${user.name}-${i}` %>">
                        <option>ARI</option>
                        <option>ATL</option>
                        <option>BAL</option>
                        <option>BUF</option>
                        <option>CAR</option>
                        <option>CHI</option>
                        <option>CIN</option>
                        <option>CLE</option>
                        <option>DAL</option>
                        <option>DEN</option>
                        <option>DET</option>
                        <option>GB</option>
                        <option>HOU</option>
                        <option>IND</option>
                        <option>JAX</option>
                        <option>KC</option>
                        <option>LAC</option>
                        <option>LAR</option>
                        <option>LV</option>
                        <option>MIA</option>
                        <option>MIN</option>
                        <option>NE</option>
                        <option>NO</option>
                        <option>NYG</option>
                        <option>NYJ</option>
                        <option>PHI</option>
                        <option>PIT</option>
                        <option>SEA</option>
                        <option>SF</option>
                        <option>TB</option>
                        <option>TEN</option>
                        <option>WAS</option>
                      </select>
                    </div>
                    <% }; %>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                  </form>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h4 class="accordion-header" id="headingTwo">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Week 2
                </button>
              </h4>
              <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse
                  plugin adds the appropriate classes that we use to style each element. These classes control the
                  overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this
                  with custom CSS or overriding our default variables. It's also worth noting that just about any HTML
                  can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h4 class="accordion-header" id="headingThree">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  Week 3
                </button>
              </h4>
              <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <strong>This is the third item's accordion body.</strong> It is hidden by default, until the collapse
                  plugin adds the appropriate classes that we use to style each element. These classes control the
                  overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this
                  with custom CSS or overriding our default variables. It's also worth noting that just about any HTML
                  can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>